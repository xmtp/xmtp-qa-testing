{
  "title": "XMTP SDK Performance",
  "description": "Metrics for XMTP SDK operations (DNS, TLS, Server Processing)",
  "widgets": [
    {
      "definition": {
        "title": "Create DM Average (ms)",
        "type": "query_value",
        "requests": [
          {
            "response_format": "scalar",
            "queries": [
              {
                "name": "query1",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createDM{*}",
                "aggregator": "avg"
              }
            ],
            "formulas": [
              {
                "formula": "query1"
              }
            ],
            "conditional_formats": [
              {
                "comparator": "<=",
                "value": 100,
                "palette": "white_on_green"
              },
              {
                "comparator": "<=",
                "value": 300,
                "palette": "white_on_yellow"
              },
              {
                "comparator": ">",
                "value": 300,
                "palette": "white_on_red"
              }
            ]
          }
        ],
        "autoscale": true,
        "precision": 2
      }
    },
    {
      "definition": {
        "title": "TLS Handshake Average (ms)",
        "type": "query_value",
        "requests": [
          {
            "response_format": "scalar",
            "queries": [
              {
                "name": "query1",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createDM.network.tls_handshake{*}",
                "aggregator": "avg"
              }
            ],
            "formulas": [
              {
                "formula": "query1"
              }
            ],
            "conditional_formats": [
              {
                "comparator": "<=",
                "value": 100,
                "palette": "white_on_green"
              },
              {
                "comparator": "<=",
                "value": 300,
                "palette": "white_on_yellow"
              },
              {
                "comparator": ">",
                "value": 300,
                "palette": "white_on_red"
              }
            ]
          }
        ],
        "autoscale": true,
        "precision": 2
      }
    },
    {
      "definition": {
        "title": "Content Transfer Average (ms)",
        "type": "query_value",
        "requests": [
          {
            "response_format": "scalar",
            "queries": [
              {
                "name": "query1",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createDM.network.content_transfer{*}",
                "aggregator": "avg"
              }
            ],
            "formulas": [
              {
                "formula": "query1"
              }
            ],
            "conditional_formats": [
              {
                "comparator": "<=",
                "value": 100,
                "palette": "white_on_green"
              },
              {
                "comparator": "<=",
                "value": 300,
                "palette": "white_on_yellow"
              },
              {
                "comparator": ">",
                "value": 300,
                "palette": "white_on_red"
              }
            ]
          }
        ],
        "autoscale": true,
        "precision": 2
      }
    },
    {
      "definition": {
        "title": "DM Operations Performance",
        "show_legend": true,
        "legend_layout": "auto",
        "type": "timeseries",
        "requests": [
          {
            "formulas": [
              { "formula": "query1", "alias": "Create DM Time" },
              { "formula": "query2", "alias": "Send GM Time" },
              { "formula": "query3", "alias": "Receive GM Time" },
              { "formula": "query4", "alias": "Create Group Time" },
              {
                "formula": "query5",
                "alias": "Create Group By Inbox Ids Time"
              },
              { "formula": "query6", "alias": "Update Group Name Time" },
              { "formula": "query7", "alias": "Add Members Time" },
              { "formula": "query8", "alias": "Remove Members Time" },
              { "formula": "query9", "alias": "Send Group Message Time" },
              { "formula": "query10", "alias": "Receive Group Message Time" },
              {
                "formula": "query11",
                "alias": "Receive Group all streams Time"
              },
              { "formula": "query12", "alias": "Create Large Group Time" }
            ],
            "queries": [
              {
                "name": "query1",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createDM{*}"
              },
              {
                "name": "query2",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.sendGM{*}"
              },
              {
                "name": "query3",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.receiveGM{*}"
              },
              {
                "name": "query4",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createGroup{*}"
              },
              {
                "name": "query5",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createGroupByInboxIds{*}"
              },
              {
                "name": "query6",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.updateGroupName{*}"
              },
              {
                "name": "query7",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.addMembers{*}"
              },
              {
                "name": "query8",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.removeMembers{*}"
              },
              {
                "name": "query9",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.sendGroupMessage{*}"
              },
              {
                "name": "query10",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.receiveGroupMessage{*}"
              },
              {
                "name": "query11",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.receiveGroupAllStreams{*}"
              },
              {
                "name": "query12",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createLargeGroup{*}"
              }
            ],
            "response_format": "timeseries",
            "display_type": "line"
          }
        ]
      }
    },
    {
      "definition": {
        "title": "Network Performance",
        "show_legend": true,
        "legend_layout": "auto",
        "type": "timeseries",
        "requests": [
          {
            "formulas": [
              { "formula": "query1", "alias": "TLS Handshake Time" },
              { "formula": "query2", "alias": "Content Transfer Time" }
            ],
            "queries": [
              {
                "name": "query1",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createDM.network.tls_handshake{*}"
              },
              {
                "name": "query2",
                "data_source": "metrics",
                "query": "avg:xmtp.sdk.ts_performance.createDM.network.content_transfer{*}"
              }
            ],
            "response_format": "timeseries",
            "display_type": "line"
          }
        ]
      }
    }
  ],
  "template_variables": [
    {
      "name": "qa_env",
      "prefix": "qa_env",
      "default": "dev"
    },
    {
      "name": "qa_geo",
      "prefix": "qa_geo",
      "default": "us"
    },
    {
      "name": "qa_test",
      "prefix": "qa_test",
      "default": "ts_performance"
    }
  ],
  "layout_type": "ordered",
  "notify_list": [],
  "reflow_type": "auto"
}
